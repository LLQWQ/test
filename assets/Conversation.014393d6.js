import{_ as Dn,aK as xn,r as be,a1 as Mn,V as Nn,o as In,c as Ln,a as Z,Q as gr,aL as jn,R as Gn,S as Bn,ad as Fn,ae as Un}from"./index.140fe4bf.js";const Wn=""+new URL("hangUp.521fb1c2.png",import.meta.url).href;(function(j){const M={WEBRTC_NOT_SUPPORT:"WEBRTC_NOT_SUPPORT",WEBRTC_ICE_CANDIDATE_ERROR:"WEBRTC_ICE_CANDIDATE_ERROR",WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED:"WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED",WEBRTC_ON_REMOTE_STREAMS:"WEBRTC_ON_REMOTE_STREAMS",WEBRTC_ON_LOCAL_STREAM:"WEBRTC_ON_LOCAL_STREAM",WEBRTC_ON_CONNECTION_STATE_CHANGE:"WEBRTC_ON_CONNECTION_STATE_CHANGE",WEBRTC_ON_DATA_CHANNEL_OPEN:"WEBRTC_ON_DATA_CHANNEL_OPEN",WEBRTC_ON_DATA_CHANNEL_CLOSE:"WEBRTC_ON_DATA_CHANNEL_CLOSE",WEBRTC_ON_DATA_CHANNEL_ERR:"WEBRTC_ON_DATA_CHANNEL_ERR",WEBRTC_ON_DATA_CHANNEL_MSG:"WEBRTC_ON_DATA_CHANNEL_MSG",CAPTURE_STREAM_FAILED:"CAPTURE_STREAM_FAILED"},ne="1.0.1",V="Mon Jul 04 2022 19:50:55 GMT+0800 (China Standard Time)";function ie(){return window.navigator.userAgent.match("Firefox")!==null}function Ae(){return window.navigator.userAgent.match("Chrome")!==null}function le(){return window.navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)!==null}const B={MIC:"mic",SCREENCAST:"screen-cast",FILE:"file",MIXED:"mixed"},_={CAMERA:"camera",SCREENCAST:"screen-cast",FILE:"file",MIXED:"mixed"},Oe={AUDIO:"audio",VIDEO:"video",AUDIO_AND_VIDEO:"av"};class X{constructor(t,r){this.width=t,this.height=r}}let K=!0,W=!0;function U(e,t,r){const n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function k(e,t,r){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(u,p){if(u!==t)return i.apply(this,arguments);const s=o=>{const c=r(o);c&&(p.handleEvent?p.handleEvent(c):p(c))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(p,s),i.apply(this,[u,s])};const a=n.removeEventListener;n.removeEventListener=function(u,p){if(u!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(p))return a.apply(this,arguments);const s=this._eventMap[t].get(p);return this._eventMap[t].delete(p),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[u,s])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(u){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),u&&this.addEventListener(t,this["_on"+t]=u)},enumerable:!0,configurable:!0})}function E(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(K=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function O(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(W=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function ke(){if(typeof window=="object"){if(K)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function de(e,t){!W||console.warn(e+" is deprecated, please use "+t+" instead.")}function Cr(e){const t={browser:null,version:null};if(typeof e>"u"||!e.navigator)return t.browser="Not a browser.",t;const{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=U(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=U(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(r.mediaDevices&&r.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=U(r.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(e.RTCPeerConnection&&r.userAgent.match(/AppleWebKit\/(\d+)\./))t.browser="safari",t.version=U(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return t.browser="Not a supported browser.",t;return t}function et(e){return Object.prototype.toString.call(e)==="[object Object]"}function tt(e){return et(e)?Object.keys(e).reduce(function(t,r){const n=et(e[r]),i=n?tt(e[r]):e[r],a=n&&!Object.keys(i).length;return i===void 0||a?t:Object.assign(t,{[r]:i})},{}):e}function De(e,t,r){!t||r.has(t.id)||(r.set(t.id,t),Object.keys(t).forEach(n=>{n.endsWith("Id")?De(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach(i=>{De(e,e.get(i),r)})}))}function rt(e,t,r){const n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(t===null)return i;const a=[];return e.forEach(u=>{u.type==="track"&&u.trackIdentifier===t.id&&a.push(u)}),a.forEach(u=>{e.forEach(p=>{p.type===n&&p.trackId===u.id&&De(e,p,i)})}),i}const nt=ke;function it(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const n=function(p){if(typeof p!="object"||p.mandatory||p.optional)return p;const s={};return Object.keys(p).forEach(o=>{if(o==="require"||o==="advanced"||o==="mediaSource")return;const c=typeof p[o]=="object"?p[o]:{ideal:p[o]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const l=function(d,h){return d?d+h.charAt(0).toUpperCase()+h.slice(1):h==="deviceId"?"sourceId":h};if(c.ideal!==void 0){s.optional=s.optional||[];let d={};typeof c.ideal=="number"?(d[l("min",o)]=c.ideal,s.optional.push(d),d={},d[l("max",o)]=c.ideal,s.optional.push(d)):(d[l("",o)]=c.ideal,s.optional.push(d))}c.exact!==void 0&&typeof c.exact!="number"?(s.mandatory=s.mandatory||{},s.mandatory[l("",o)]=c.exact):["min","max"].forEach(d=>{c[d]!==void 0&&(s.mandatory=s.mandatory||{},s.mandatory[l(d,o)]=c[d])})}),p.advanced&&(s.optional=(s.optional||[]).concat(p.advanced)),s},i=function(p,s){if(t.version>=61)return s(p);if(p=JSON.parse(JSON.stringify(p)),p&&typeof p.audio=="object"){const o=function(c,l,d){l in c&&!(d in c)&&(c[d]=c[l],delete c[l])};p=JSON.parse(JSON.stringify(p)),o(p.audio,"autoGainControl","googAutoGainControl"),o(p.audio,"noiseSuppression","googNoiseSuppression"),p.audio=n(p.audio)}if(p&&typeof p.video=="object"){let o=p.video.facingMode;o=o&&(typeof o=="object"?o:{ideal:o});const c=t.version<66;if(o&&(o.exact==="user"||o.exact==="environment"||o.ideal==="user"||o.ideal==="environment")&&!(r.mediaDevices.getSupportedConstraints&&r.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete p.video.facingMode;let l;if(o.exact==="environment"||o.ideal==="environment"?l=["back","rear"]:(o.exact==="user"||o.ideal==="user")&&(l=["front"]),l)return r.mediaDevices.enumerateDevices().then(d=>{d=d.filter(f=>f.kind==="videoinput");let h=d.find(f=>l.some(g=>f.label.toLowerCase().includes(g)));return!h&&d.length&&l.includes("back")&&(h=d[d.length-1]),h&&(p.video.deviceId=o.exact?{exact:h.deviceId}:{ideal:h.deviceId}),p.video=n(p.video),nt("chrome: "+JSON.stringify(p)),s(p)})}p.video=n(p.video)}return nt("chrome: "+JSON.stringify(p)),s(p)},a=function(p){return t.version>=64?p:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[p.name]||p.name,message:p.message,constraint:p.constraint||p.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},u=function(p,s,o){i(p,c=>{r.webkitGetUserMedia(c,s,l=>{o&&o(a(l))})})};if(r.getUserMedia=u.bind(r),r.mediaDevices.getUserMedia){const p=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(s){return i(s,o=>p(o).then(c=>{if(o.audio&&!c.getAudioTracks().length||o.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(l=>{l.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(a(c))))}}}function Tr(e,t){if(!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&!!e.navigator.mediaDevices){if(typeof t!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(i=>{const a=n.video&&n.video.width,u=n.video&&n.video.height,p=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:p||3}},a&&(n.video.mandatory.maxWidth=a),u&&(n.video.mandatory.maxHeight=u),e.navigator.mediaDevices.getUserMedia(n)})}}}function at(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function st(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",i=>{let a;e.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(p=>p.track&&p.track.id===i.track.id):a={track:i.track};const u=new Event("track");u.track=i.track,u.receiver=a,u.transceiver={receiver:a},u.streams=[n.stream],this.dispatchEvent(u)}),n.stream.getTracks().forEach(i=>{let a;e.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(p=>p.track&&p.track.id===i.id):a={track:i};const u=new Event("track");u.track=i,u.receiver=a,u.transceiver={receiver:a},u.streams=[n.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else k(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function ot(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(i,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=i.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:i}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(p,s){let o=i.apply(this,arguments);return o||(o=t(this,p),this._senders.push(o)),o};const a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(p){a.apply(this,arguments);const s=this._senders.indexOf(p);s!==-1&&this._senders.splice(s,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(u=>{this._senders.push(t(this,u))})};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(u=>{const p=this._senders.find(s=>s.track===u);p&&this._senders.splice(this._senders.indexOf(p),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ct(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[n,i,a]=arguments;if(arguments.length>0&&typeof n=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof n!="function"))return t.apply(this,[]);const u=function(s){const o={};return s.result().forEach(l=>{const d={id:l.id,timestamp:l.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[l.type]||l.type};l.names().forEach(h=>{d[h]=l.stat(h)}),o[d.id]=d}),o},p=function(s){return new Map(Object.keys(s).map(o=>[o,s[o]]))};if(arguments.length>=2){const s=function(o){i(p(u(o)))};return t.apply(this,[s,n])}return new Promise((s,o)=>{t.apply(this,[function(c){s(p(u(c)))},o])}).then(i,a)}}function ut(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const a=r.apply(this,[]);return a.forEach(u=>u._pc=this),a});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const a=n.apply(this,arguments);return a._pc=this,a}),e.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(u=>rt(u,a.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=r.apply(this,[]);return i.forEach(a=>a._pc=this),i}),k(e,"track",n=>(n.receiver._pc=n.srcElement,n)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(a=>rt(a,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const n=arguments[0];let i,a,u;return this.getSenders().forEach(p=>{p.track===n&&(i?u=!0:i=p)}),this.getReceivers().forEach(p=>(p.track===n&&(a?u=!0:a=p),p.track===n)),u||i&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function pt(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(u,p){if(!p)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const s=t.apply(this,arguments);return this._shimmedLocalStreams[p.id]?this._shimmedLocalStreams[p.id].indexOf(s)===-1&&this._shimmedLocalStreams[p.id].push(s):this._shimmedLocalStreams[p.id]=[p,s],s};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(o=>{if(this.getSenders().find(l=>l.track===o))throw new DOMException("Track already exists.","InvalidAccessError")});const p=this.getSenders();r.apply(this,arguments);const s=this.getSenders().filter(o=>p.indexOf(o)===-1);this._shimmedLocalStreams[u.id]=[u].concat(s)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],n.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(p=>{const s=this._shimmedLocalStreams[p].indexOf(u);s!==-1&&this._shimmedLocalStreams[p].splice(s,1),this._shimmedLocalStreams[p].length===1&&delete this._shimmedLocalStreams[p]}),i.apply(this,arguments)}}function lt(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return pt(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const c=r.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(l=>this._reverseStreams[l.id])};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(l=>{if(this.getSenders().find(h=>h.track===l))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const l=new e.MediaStream(c.getTracks());this._streams[c.id]=l,this._reverseStreams[l.id]=c,c=l}n.apply(this,[c])};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},e.RTCPeerConnection.prototype.addTrack=function(c,l){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(g=>g===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const f=this._streams[l.id];if(f)f.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new e.MediaStream([c]);this._streams[l.id]=g,this._reverseStreams[g.id]=l,this.addStream(g)}return this.getSenders().find(g=>g.track===c)};function a(o,c){let l=c.sdp;return Object.keys(o._reverseStreams||[]).forEach(d=>{const h=o._reverseStreams[d],f=o._streams[h.id];l=l.replace(new RegExp(f.id,"g"),h.id)}),new RTCSessionDescription({type:c.type,sdp:l})}function u(o,c){let l=c.sdp;return Object.keys(o._reverseStreams||[]).forEach(d=>{const h=o._reverseStreams[d],f=o._streams[h.id];l=l.replace(new RegExp(h.id,"g"),f.id)}),new RTCSessionDescription({type:c.type,sdp:l})}["createOffer","createAnswer"].forEach(function(o){const c=e.RTCPeerConnection.prototype[o],l={[o](){const d=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[f=>{const g=a(this,f);d[0].apply(null,[g])},f=>{d[1]&&d[1].apply(null,f)},arguments[2]]):c.apply(this,arguments).then(f=>a(this,f))}};e.RTCPeerConnection.prototype[o]=l[o]});const p=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?p.apply(this,arguments):(arguments[0]=u(this,arguments[0]),p.apply(this,arguments))};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const o=s.get.apply(this);return o.type===""?o:a(this,o)}}),e.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(h=>{this._streams[h].getTracks().find(g=>c.track===g)&&(d=this._streams[h])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function xe(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!!e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const n=e.RTCPeerConnection.prototype[r],i={[r](){return arguments[0]=new(r==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=i[r]})}function dt(e,t){k(e,"negotiationneeded",r=>{const n=r.target;if(!((t.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return r})}var ft=Object.freeze({__proto__:null,shimMediaStream:at,shimOnTrack:st,shimGetSendersWithDtmf:ot,shimGetStats:ct,shimSenderReceiverGetStats:ut,shimAddTrackRemoveTrackWithNative:pt,shimAddTrackRemoveTrack:lt,shimPeerConnection:xe,fixNegotiationNeeded:dt,shimGetUserMedia:it,shimGetDisplayMedia:Tr});function yr(e,t){let r=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(n=>{if(n&&(n.urls||n.url)){let i=n.urls||n.url;n.url&&!n.urls&&de("RTCIceServer.url","RTCIceServer.urls");const a=typeof i=="string";return a&&(i=[i]),i=i.filter(u=>{if(u.indexOf("stun:")===0)return!1;const p=u.startsWith("turn")&&!u.startsWith("turn:[")&&u.includes("transport=udp");return p&&!r?(r=!0,!0):p&&!r}),delete n.url,n.urls=a?i[0]:i,!!i.length}})}function Er(e){var t={exports:{}};return e(t,t.exports),t.exports}var C=Er(function(e){var t={};t.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},t.localCName=t.generateIdentifier(),t.splitLines=function(r){return r.trim().split(`
`).map(function(n){return n.trim()})},t.splitSections=function(r){var n=r.split(`
m=`);return n.map(function(i,a){return(a>0?"m="+i:i).trim()+`\r
`})},t.getDescription=function(r){var n=t.splitSections(r);return n&&n[0]},t.getMediaSections=function(r){var n=t.splitSections(r);return n.shift(),n},t.matchPrefix=function(r,n){return t.splitLines(r).filter(function(i){return i.indexOf(n)===0})},t.parseCandidate=function(r){var n;r.indexOf("a=candidate:")===0?n=r.substring(12).split(" "):n=r.substring(10).split(" ");for(var i={foundation:n[0],component:parseInt(n[1],10),protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]},a=8;a<n.length;a+=2)switch(n[a]){case"raddr":i.relatedAddress=n[a+1];break;case"rport":i.relatedPort=parseInt(n[a+1],10);break;case"tcptype":i.tcpType=n[a+1];break;case"ufrag":i.ufrag=n[a+1],i.usernameFragment=n[a+1];break;default:i[n[a]]=n[a+1];break}return i},t.writeCandidate=function(r){var n=[];n.push(r.foundation),n.push(r.component),n.push(r.protocol.toUpperCase()),n.push(r.priority),n.push(r.address||r.ip),n.push(r.port);var i=r.type;return n.push("typ"),n.push(i),i!=="host"&&r.relatedAddress&&r.relatedPort&&(n.push("raddr"),n.push(r.relatedAddress),n.push("rport"),n.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(n.push("ufrag"),n.push(r.usernameFragment||r.ufrag)),"candidate:"+n.join(" ")},t.parseIceOptions=function(r){return r.substr(14).split(" ")},t.parseRtpMap=function(r){var n=r.substr(9).split(" "),i={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),i.name=n[0],i.clockRate=parseInt(n[1],10),i.channels=n.length===3?parseInt(n[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(r){var n=r.payloadType;r.preferredPayloadType!==void 0&&(n=r.preferredPayloadType);var i=r.channels||r.numChannels||1;return"a=rtpmap:"+n+" "+r.name+"/"+r.clockRate+(i!==1?"/"+i:"")+`\r
`},t.parseExtmap=function(r){var n=r.substr(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1]}},t.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+`\r
`},t.parseFmtp=function(r){for(var n={},i,a=r.substr(r.indexOf(" ")+1).split(";"),u=0;u<a.length;u++)i=a[u].trim().split("="),n[i[0].trim()]=i[1];return n},t.writeFmtp=function(r){var n="",i=r.payloadType;if(r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var a=[];Object.keys(r.parameters).forEach(function(u){r.parameters[u]?a.push(u+"="+r.parameters[u]):a.push(u)}),n+="a=fmtp:"+i+" "+a.join(";")+`\r
`}return n},t.parseRtcpFb=function(r){var n=r.substr(r.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},t.writeRtcpFb=function(r){var n="",i=r.payloadType;return r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(function(a){n+="a=rtcp-fb:"+i+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),n},t.parseSsrcMedia=function(r){var n=r.indexOf(" "),i={ssrc:parseInt(r.substr(7,n-7),10)},a=r.indexOf(":",n);return a>-1?(i.attribute=r.substr(n+1,a-n-1),i.value=r.substr(a+1)):i.attribute=r.substr(n+1),i},t.parseSsrcGroup=function(r){var n=r.substr(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(function(i){return parseInt(i,10)})}},t.getMid=function(r){var n=t.matchPrefix(r,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(r){var n=r.substr(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1]}},t.getDtlsParameters=function(r,n){var i=t.matchPrefix(r+n,"a=fingerprint:");return{role:"auto",fingerprints:i.map(t.parseFingerprint)}},t.writeDtlsParameters=function(r,n){var i="a=setup:"+n+`\r
`;return r.fingerprints.forEach(function(a){i+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),i},t.parseCryptoLine=function(r){var n=r.substr(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},t.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?t.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;var n=r.substr(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},t.getCryptoParameters=function(r,n){var i=t.matchPrefix(r+n,"a=crypto:");return i.map(t.parseCryptoLine)},t.getIceParameters=function(r,n){var i=t.matchPrefix(r+n,"a=ice-ufrag:")[0],a=t.matchPrefix(r+n,"a=ice-pwd:")[0];return i&&a?{usernameFragment:i.substr(12),password:a.substr(10)}:null},t.writeIceParameters=function(r){return"a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`},t.parseRtpParameters=function(r){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(r),a=i[0].split(" "),u=3;u<a.length;u++){var p=a[u],s=t.matchPrefix(r,"a=rtpmap:"+p+" ")[0];if(s){var o=t.parseRtpMap(s),c=t.matchPrefix(r,"a=fmtp:"+p+" ");switch(o.parameters=c.length?t.parseFmtp(c[0]):{},o.rtcpFeedback=t.matchPrefix(r,"a=rtcp-fb:"+p+" ").map(t.parseRtcpFb),n.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(o.name.toUpperCase());break}}}return t.matchPrefix(r,"a=extmap:").forEach(function(l){n.headerExtensions.push(t.parseExtmap(l))}),n},t.writeRtpDescription=function(r,n){var i="";i+="m="+r+" ",i+=n.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=n.codecs.map(function(u){return u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType}).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(function(u){i+=t.writeRtpMap(u),i+=t.writeFmtp(u),i+=t.writeRtcpFb(u)});var a=0;return n.codecs.forEach(function(u){u.maxptime>a&&(a=u.maxptime)}),a>0&&(i+="a=maxptime:"+a+`\r
`),i+=`a=rtcp-mux\r
`,n.headerExtensions&&n.headerExtensions.forEach(function(u){i+=t.writeExtmap(u)}),i},t.parseRtpEncodingParameters=function(r){var n=[],i=t.parseRtpParameters(r),a=i.fecMechanisms.indexOf("RED")!==-1,u=i.fecMechanisms.indexOf("ULPFEC")!==-1,p=t.matchPrefix(r,"a=ssrc:").map(function(d){return t.parseSsrcMedia(d)}).filter(function(d){return d.attribute==="cname"}),s=p.length>0&&p[0].ssrc,o,c=t.matchPrefix(r,"a=ssrc-group:FID").map(function(d){var h=d.substr(17).split(" ");return h.map(function(f){return parseInt(f,10)})});c.length>0&&c[0].length>1&&c[0][0]===s&&(o=c[0][1]),i.codecs.forEach(function(d){if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){var h={ssrc:s,codecPayloadType:parseInt(d.parameters.apt,10)};s&&o&&(h.rtx={ssrc:o}),n.push(h),a&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:s,mechanism:u?"red+ulpfec":"red"},n.push(h))}}),n.length===0&&s&&n.push({ssrc:s});var l=t.matchPrefix(r,"b=");return l.length&&(l[0].indexOf("b=TIAS:")===0?l=parseInt(l[0].substr(7),10):l[0].indexOf("b=AS:")===0?l=parseInt(l[0].substr(5),10)*1e3*.95-50*40*8:l=void 0,n.forEach(function(d){d.maxBitrate=l})),n},t.parseRtcpParameters=function(r){var n={},i=t.matchPrefix(r,"a=ssrc:").map(function(p){return t.parseSsrcMedia(p)}).filter(function(p){return p.attribute==="cname"})[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);var a=t.matchPrefix(r,"a=rtcp-rsize");n.reducedSize=a.length>0,n.compound=a.length===0;var u=t.matchPrefix(r,"a=rtcp-mux");return n.mux=u.length>0,n},t.parseMsid=function(r){var n,i=t.matchPrefix(r,"a=msid:");if(i.length===1)return n=i[0].substr(7).split(" "),{stream:n[0],track:n[1]};var a=t.matchPrefix(r,"a=ssrc:").map(function(u){return t.parseSsrcMedia(u)}).filter(function(u){return u.attribute==="msid"});if(a.length>0)return n=a[0].value.split(" "),{stream:n[0],track:n[1]}},t.parseSctpDescription=function(r){var n=t.parseMLine(r),i=t.matchPrefix(r,"a=max-message-size:"),a;i.length>0&&(a=parseInt(i[0].substr(19),10)),isNaN(a)&&(a=65536);var u=t.matchPrefix(r,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substr(12),10),protocol:n.fmt,maxMessageSize:a};var p=t.matchPrefix(r,"a=sctpmap:");if(p.length>0){var s=t.matchPrefix(r,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:a}}},t.writeSctpDescription=function(r,n){var i=[];return r.protocol!=="DTLS/SCTP"?i=["m="+r.kind+" 9 "+r.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:i=["m="+r.kind+" 9 "+r.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&i.push("a=max-message-size:"+n.maxMessageSize+`\r
`),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(r,n,i){var a,u=n!==void 0?n:2;r?a=r:a=t.generateSessionId();var p=i||"thisisadapterortc";return`v=0\r
o=`+p+" "+a+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.writeMediaSection=function(r,n,i,a){var u=t.writeRtpDescription(r.kind,n);if(u+=t.writeIceParameters(r.iceGatherer.getLocalParameters()),u+=t.writeDtlsParameters(r.dtlsTransport.getLocalParameters(),i==="offer"?"actpass":"active"),u+="a=mid:"+r.mid+`\r
`,r.direction?u+="a="+r.direction+`\r
`:r.rtpSender&&r.rtpReceiver?u+=`a=sendrecv\r
`:r.rtpSender?u+=`a=sendonly\r
`:r.rtpReceiver?u+=`a=recvonly\r
`:u+=`a=inactive\r
`,r.rtpSender){var p="msid:"+a.id+" "+r.rtpSender.track.id+`\r
`;u+="a="+p,u+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" "+p,r.sendEncodingParameters[0].rtx&&(u+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" "+p,u+="a=ssrc-group:FID "+r.sendEncodingParameters[0].ssrc+" "+r.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return u+="a=ssrc:"+r.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+`\r
`,r.rtpSender&&r.sendEncodingParameters[0].rtx&&(u+="a=ssrc:"+r.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+`\r
`),u},t.getDirection=function(r,n){for(var i=t.splitLines(r),a=0;a<i.length;a++)switch(i[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[a].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(r){var n=t.splitLines(r),i=n[0].split(" ");return i[0].substr(2)},t.isRejected=function(r){return r.split(" ",2)[1]==="0"},t.parseMLine=function(r){var n=t.splitLines(r),i=n[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(r){var n=t.matchPrefix(r,"o=")[0],i=n.substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;for(var n=t.splitLines(r),i=0;i<n.length;i++)if(n[i].length<2||n[i].charAt(1)!=="=")return!1;return!0},e.exports=t});function Sr(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function ht(e,t,r,n,i){var a=C.writeRtpDescription(e.kind,t);if(a+=C.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=C.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":i||"active"),a+="a=mid:"+e.mid+`\r
`,e.rtpSender&&e.rtpReceiver?a+=`a=sendrecv\r
`:e.rtpSender?a+=`a=sendonly\r
`:e.rtpReceiver?a+=`a=recvonly\r
`:a+=`a=inactive\r
`,e.rtpSender){var u=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=u;var p="msid:"+(n?n.id:"-")+" "+u+`\r
`;a+="a="+p,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+p,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+p,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+C.localCName+`\r
`,e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+C.localCName+`\r
`),a}function Rr(e,t){var r=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(function(n){if(n&&(n.urls||n.url)){var i=n.urls||n.url;n.url&&!n.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var a=typeof i=="string";return a&&(i=[i]),i=i.filter(function(u){var p=u.indexOf("turn:")===0&&u.indexOf("transport=udp")!==-1&&u.indexOf("turn:[")===-1&&!r;return p?(r=!0,!0):u.indexOf("stun:")===0&&t>=14393&&u.indexOf("?transport=udp")===-1}),delete n.url,n.urls=a?i[0]:i,!!i.length}})}function fe(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(a,u){a=parseInt(a,10);for(var p=0;p<u.length;p++)if(u[p].payloadType===a||u[p].preferredPayloadType===a)return u[p]},i=function(a,u,p,s){var o=n(a.parameters.apt,p),c=n(u.parameters.apt,s);return o&&c&&o.name.toLowerCase()===c.name.toLowerCase()};return e.codecs.forEach(function(a){for(var u=0;u<t.codecs.length;u++){var p=t.codecs[u];if(a.name.toLowerCase()===p.name.toLowerCase()&&a.clockRate===p.clockRate){if(a.name.toLowerCase()==="rtx"&&a.parameters&&p.parameters.apt&&!i(a,p,e.codecs,t.codecs))continue;p=JSON.parse(JSON.stringify(p)),p.numChannels=Math.min(a.numChannels,p.numChannels),r.codecs.push(p),p.rtcpFeedback=p.rtcpFeedback.filter(function(s){for(var o=0;o<a.rtcpFeedback.length;o++)if(a.rtcpFeedback[o].type===s.type&&a.rtcpFeedback[o].parameter===s.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(a){for(var u=0;u<t.headerExtensions.length;u++){var p=t.headerExtensions[u];if(a.uri===p.uri){r.headerExtensions.push(p);break}}}),r}function mt(e,t,r){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)!==-1}function Me(e,t){var r=e.getRemoteCandidates().find(function(n){return t.foundation===n.foundation&&t.ip===n.ip&&t.port===n.port&&t.priority===n.priority&&t.protocol===n.protocol&&t.type===n.type});return r||e.addRemoteCandidate(t),!r}function D(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}var _r=function(e,t){function r(s,o){o.addTrack(s),o.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:s}))}function n(s,o){o.removeTrack(s),o.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:s}))}function i(s,o,c,l){var d=new Event("track");d.track=o,d.receiver=c,d.transceiver={receiver:c},d.streams=l,e.setTimeout(function(){s._dispatchEvent("track",d)})}var a=function(s){var o=this,c=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(d){o[d]=c[d].bind(c)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",s=JSON.parse(JSON.stringify(s||{})),this.usingBundle=s.bundlePolicy==="max-bundle",s.rtcpMuxPolicy==="negotiate")throw D("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(s.rtcpMuxPolicy||(s.rtcpMuxPolicy="require"),s.iceTransportPolicy){case"all":case"relay":break;default:s.iceTransportPolicy="all";break}switch(s.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:s.bundlePolicy="balanced";break}if(s.iceServers=Rr(s.iceServers||[],t),this._iceGatherers=[],s.iceCandidatePoolSize)for(var l=s.iceCandidatePoolSize;l>0;l--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:s.iceServers,gatherPolicy:s.iceTransportPolicy}));else s.iceCandidatePoolSize=0;this._config=s,this.transceivers=[],this._sdpSessionId=C.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(a.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(a.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),a.prototype.onicecandidate=null,a.prototype.onaddstream=null,a.prototype.ontrack=null,a.prototype.onremovestream=null,a.prototype.onsignalingstatechange=null,a.prototype.oniceconnectionstatechange=null,a.prototype.onconnectionstatechange=null,a.prototype.onicegatheringstatechange=null,a.prototype.onnegotiationneeded=null,a.prototype.ondatachannel=null,a.prototype._dispatchEvent=function(s,o){this._isClosed||(this.dispatchEvent(o),typeof this["on"+s]=="function"&&this["on"+s](o))},a.prototype._emitGatheringStateChange=function(){var s=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",s)},a.prototype.getConfiguration=function(){return this._config},a.prototype.getLocalStreams=function(){return this.localStreams},a.prototype.getRemoteStreams=function(){return this.remoteStreams},a.prototype._createTransceiver=function(s,o){var c=this.transceivers.length>0,l={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:s,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&c)l.iceTransport=this.transceivers[0].iceTransport,l.dtlsTransport=this.transceivers[0].dtlsTransport;else{var d=this._createIceAndDtlsTransports();l.iceTransport=d.iceTransport,l.dtlsTransport=d.dtlsTransport}return o||this.transceivers.push(l),l},a.prototype.addTrack=function(s,o){if(this._isClosed)throw D("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var c=this.transceivers.find(function(h){return h.track===s});if(c)throw D("InvalidAccessError","Track already exists.");for(var l,d=0;d<this.transceivers.length;d++)!this.transceivers[d].track&&this.transceivers[d].kind===s.kind&&(l=this.transceivers[d]);return l||(l=this._createTransceiver(s.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(o)===-1&&this.localStreams.push(o),l.track=s,l.stream=o,l.rtpSender=new e.RTCRtpSender(s,l.dtlsTransport),l.rtpSender},a.prototype.addStream=function(s){var o=this;if(t>=15025)s.getTracks().forEach(function(l){o.addTrack(l,s)});else{var c=s.clone();s.getTracks().forEach(function(l,d){var h=c.getTracks()[d];l.addEventListener("enabled",function(f){h.enabled=f.enabled})}),c.getTracks().forEach(function(l){o.addTrack(l,c)})}},a.prototype.removeTrack=function(s){if(this._isClosed)throw D("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(s instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var o=this.transceivers.find(function(d){return d.rtpSender===s});if(!o)throw D("InvalidAccessError","Sender was not created by this connection.");var c=o.stream;o.rtpSender.stop(),o.rtpSender=null,o.track=null,o.stream=null;var l=this.transceivers.map(function(d){return d.stream});l.indexOf(c)===-1&&this.localStreams.indexOf(c)>-1&&this.localStreams.splice(this.localStreams.indexOf(c),1),this._maybeFireNegotiationNeeded()},a.prototype.removeStream=function(s){var o=this;s.getTracks().forEach(function(c){var l=o.getSenders().find(function(d){return d.track===c});l&&o.removeTrack(l)})},a.prototype.getSenders=function(){return this.transceivers.filter(function(s){return!!s.rtpSender}).map(function(s){return s.rtpSender})},a.prototype.getReceivers=function(){return this.transceivers.filter(function(s){return!!s.rtpReceiver}).map(function(s){return s.rtpReceiver})},a.prototype._createIceGatherer=function(s,o){var c=this;if(o&&s>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var l=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(l,"state",{value:"new",writable:!0}),this.transceivers[s].bufferedCandidateEvents=[],this.transceivers[s].bufferCandidates=function(d){var h=!d.candidate||Object.keys(d.candidate).length===0;l.state=h?"completed":"gathering",c.transceivers[s].bufferedCandidateEvents!==null&&c.transceivers[s].bufferedCandidateEvents.push(d)},l.addEventListener("localcandidate",this.transceivers[s].bufferCandidates),l},a.prototype._gather=function(s,o){var c=this,l=this.transceivers[o].iceGatherer;if(!l.onlocalcandidate){var d=this.transceivers[o].bufferedCandidateEvents;this.transceivers[o].bufferedCandidateEvents=null,l.removeEventListener("localcandidate",this.transceivers[o].bufferCandidates),l.onlocalcandidate=function(h){if(!(c.usingBundle&&o>0)){var f=new Event("icecandidate");f.candidate={sdpMid:s,sdpMLineIndex:o};var g=h.candidate,P=!g||Object.keys(g).length===0;if(P)(l.state==="new"||l.state==="gathering")&&(l.state="completed");else{l.state==="new"&&(l.state="gathering"),g.component=1,g.ufrag=l.getLocalParameters().usernameFragment;var v=C.writeCandidate(g);f.candidate=Object.assign(f.candidate,C.parseCandidate(v)),f.candidate.candidate=v,f.candidate.toJSON=function(){return{candidate:f.candidate.candidate,sdpMid:f.candidate.sdpMid,sdpMLineIndex:f.candidate.sdpMLineIndex,usernameFragment:f.candidate.usernameFragment}}}var T=C.getMediaSections(c._localDescription.sdp);P?T[f.candidate.sdpMLineIndex]+=`a=end-of-candidates\r
`:T[f.candidate.sdpMLineIndex]+="a="+f.candidate.candidate+`\r
`,c._localDescription.sdp=C.getDescription(c._localDescription.sdp)+T.join("");var b=c.transceivers.every(function(A){return A.iceGatherer&&A.iceGatherer.state==="completed"});c.iceGatheringState!=="gathering"&&(c.iceGatheringState="gathering",c._emitGatheringStateChange()),P||c._dispatchEvent("icecandidate",f),b&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}},e.setTimeout(function(){d.forEach(function(h){l.onlocalcandidate(h)})},0)}},a.prototype._createIceAndDtlsTransports=function(){var s=this,o=new e.RTCIceTransport(null);o.onicestatechange=function(){s._updateIceConnectionState(),s._updateConnectionState()};var c=new e.RTCDtlsTransport(o);return c.ondtlsstatechange=function(){s._updateConnectionState()},c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0}),s._updateConnectionState()},{iceTransport:o,dtlsTransport:c}},a.prototype._disposeIceAndDtlsTransports=function(s){var o=this.transceivers[s].iceGatherer;o&&(delete o.onlocalcandidate,delete this.transceivers[s].iceGatherer);var c=this.transceivers[s].iceTransport;c&&(delete c.onicestatechange,delete this.transceivers[s].iceTransport);var l=this.transceivers[s].dtlsTransport;l&&(delete l.ondtlsstatechange,delete l.onerror,delete this.transceivers[s].dtlsTransport)},a.prototype._transceive=function(s,o,c){var l=fe(s.localCapabilities,s.remoteCapabilities);o&&s.rtpSender&&(l.encodings=s.sendEncodingParameters,l.rtcp={cname:C.localCName,compound:s.rtcpParameters.compound},s.recvEncodingParameters.length&&(l.rtcp.ssrc=s.recvEncodingParameters[0].ssrc),s.rtpSender.send(l)),c&&s.rtpReceiver&&l.codecs.length>0&&(s.kind==="video"&&s.recvEncodingParameters&&t<15019&&s.recvEncodingParameters.forEach(function(d){delete d.rtx}),s.recvEncodingParameters.length?l.encodings=s.recvEncodingParameters:l.encodings=[{}],l.rtcp={compound:s.rtcpParameters.compound},s.rtcpParameters.cname&&(l.rtcp.cname=s.rtcpParameters.cname),s.sendEncodingParameters.length&&(l.rtcp.ssrc=s.sendEncodingParameters[0].ssrc),s.rtpReceiver.receive(l))},a.prototype.setLocalDescription=function(s){var o=this;if(["offer","answer"].indexOf(s.type)===-1)return Promise.reject(D("TypeError",'Unsupported type "'+s.type+'"'));if(!mt("setLocalDescription",s.type,o.signalingState)||o._isClosed)return Promise.reject(D("InvalidStateError","Can not set local "+s.type+" in state "+o.signalingState));var c,l;if(s.type==="offer")c=C.splitSections(s.sdp),l=c.shift(),c.forEach(function(h,f){var g=C.parseRtpParameters(h);o.transceivers[f].localCapabilities=g}),o.transceivers.forEach(function(h,f){o._gather(h.mid,f)});else if(s.type==="answer"){c=C.splitSections(o._remoteDescription.sdp),l=c.shift();var d=C.matchPrefix(l,"a=ice-lite").length>0;c.forEach(function(h,f){var g=o.transceivers[f],P=g.iceGatherer,v=g.iceTransport,T=g.dtlsTransport,b=g.localCapabilities,A=g.remoteCapabilities,R=C.isRejected(h)&&C.matchPrefix(h,"a=bundle-only").length===0;if(!R&&!g.rejected){var G=C.getIceParameters(h,l),I=C.getDtlsParameters(h,l);d&&(I.role="server"),(!o.usingBundle||f===0)&&(o._gather(g.mid,f),v.state==="new"&&v.start(P,G,d?"controlling":"controlled"),T.state==="new"&&T.start(I));var x=fe(b,A);o._transceive(g,x.codecs.length>0,!1)}})}return o._localDescription={type:s.type,sdp:s.sdp},s.type==="offer"?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},a.prototype.setRemoteDescription=function(s){var o=this;if(["offer","answer"].indexOf(s.type)===-1)return Promise.reject(D("TypeError",'Unsupported type "'+s.type+'"'));if(!mt("setRemoteDescription",s.type,o.signalingState)||o._isClosed)return Promise.reject(D("InvalidStateError","Can not set remote "+s.type+" in state "+o.signalingState));var c={};o.remoteStreams.forEach(function(v){c[v.id]=v});var l=[],d=C.splitSections(s.sdp),h=d.shift(),f=C.matchPrefix(h,"a=ice-lite").length>0,g=C.matchPrefix(h,"a=group:BUNDLE ").length>0;o.usingBundle=g;var P=C.matchPrefix(h,"a=ice-options:")[0];return P?o.canTrickleIceCandidates=P.substr(14).split(" ").indexOf("trickle")>=0:o.canTrickleIceCandidates=!1,d.forEach(function(v,T){var b=C.splitLines(v),A=C.getKind(v),R=C.isRejected(v)&&C.matchPrefix(v,"a=bundle-only").length===0,G=b[0].substr(2).split(" ")[2],I=C.getDirection(v,h),x=C.parseMsid(v),pr=C.getMid(v)||C.generateIdentifier();if(R||A==="application"&&(G==="DTLS/SCTP"||G==="UDP/DTLS/SCTP")){o.transceivers[T]={mid:pr,kind:A,protocol:G,rejected:!0};return}!R&&o.transceivers[T]&&o.transceivers[T].rejected&&(o.transceivers[T]=o._createTransceiver(A,!0));var y,lr,ue,Xe,z,Ke,Qe,pe,H,dr=C.parseRtpParameters(v),fr,Ye;R||(fr=C.getIceParameters(v,h),Ye=C.getDtlsParameters(v,h),Ye.role="client"),Qe=C.parseRtpEncodingParameters(v);var hr=C.parseRtcpParameters(v),mr=C.matchPrefix(v,"a=end-of-candidates",h).length>0,te=C.matchPrefix(v,"a=candidate:").map(function(L){return C.parseCandidate(L)}).filter(function(L){return L.component===1});if((s.type==="offer"||s.type==="answer")&&!R&&g&&T>0&&o.transceivers[T]&&(o._disposeIceAndDtlsTransports(T),o.transceivers[T].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[T].iceTransport=o.transceivers[0].iceTransport,o.transceivers[T].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[T].rtpSender&&o.transceivers[T].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[T].rtpReceiver&&o.transceivers[T].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),s.type==="offer"&&!R){y=o.transceivers[T]||o._createTransceiver(A),y.mid=pr,y.iceGatherer||(y.iceGatherer=o._createIceGatherer(T,g)),te.length&&y.iceTransport.state==="new"&&(mr&&(!g||T===0)?y.iceTransport.setRemoteCandidates(te):te.forEach(function(L){Me(y.iceTransport,L)})),pe=e.RTCRtpReceiver.getCapabilities(A),t<15019&&(pe.codecs=pe.codecs.filter(function(L){return L.name!=="rtx"})),Ke=y.sendEncodingParameters||[{ssrc:(2*T+2)*1001}];var we=!1;if(I==="sendrecv"||I==="sendonly"){if(we=!y.rtpReceiver,z=y.rtpReceiver||new e.RTCRtpReceiver(y.dtlsTransport,A),we){var re;H=z.track,x&&x.stream==="-"||(x?(c[x.stream]||(c[x.stream]=new e.MediaStream,Object.defineProperty(c[x.stream],"id",{get:function(){return x.stream}})),Object.defineProperty(H,"id",{get:function(){return x.track}}),re=c[x.stream]):(c.default||(c.default=new e.MediaStream),re=c.default)),re&&(r(H,re),y.associatedRemoteMediaStreams.push(re)),l.push([H,z,re])}}else y.rtpReceiver&&y.rtpReceiver.track&&(y.associatedRemoteMediaStreams.forEach(function(L){var vr=L.getTracks().find(function(kn){return kn.id===y.rtpReceiver.track.id});vr&&n(vr,L)}),y.associatedRemoteMediaStreams=[]);y.localCapabilities=pe,y.remoteCapabilities=dr,y.rtpReceiver=z,y.rtcpParameters=hr,y.sendEncodingParameters=Ke,y.recvEncodingParameters=Qe,o._transceive(o.transceivers[T],!1,we)}else if(s.type==="answer"&&!R){y=o.transceivers[T],lr=y.iceGatherer,ue=y.iceTransport,Xe=y.dtlsTransport,z=y.rtpReceiver,Ke=y.sendEncodingParameters,pe=y.localCapabilities,o.transceivers[T].recvEncodingParameters=Qe,o.transceivers[T].remoteCapabilities=dr,o.transceivers[T].rtcpParameters=hr,te.length&&ue.state==="new"&&((f||mr)&&(!g||T===0)?ue.setRemoteCandidates(te):te.forEach(function(L){Me(y.iceTransport,L)})),(!g||T===0)&&(ue.state==="new"&&ue.start(lr,fr,"controlling"),Xe.state==="new"&&Xe.start(Ye));var An=fe(y.localCapabilities,y.remoteCapabilities),On=An.codecs.filter(function(L){return L.name.toLowerCase()==="rtx"}).length;!On&&y.sendEncodingParameters[0].rtx&&delete y.sendEncodingParameters[0].rtx,o._transceive(y,I==="sendrecv"||I==="recvonly",I==="sendrecv"||I==="sendonly"),z&&(I==="sendrecv"||I==="sendonly")?(H=z.track,x?(c[x.stream]||(c[x.stream]=new e.MediaStream),r(H,c[x.stream]),l.push([H,z,c[x.stream]])):(c.default||(c.default=new e.MediaStream),r(H,c.default),l.push([H,z,c.default]))):delete y.rtpReceiver}}),o._dtlsRole===void 0&&(o._dtlsRole=s.type==="offer"?"active":"passive"),o._remoteDescription={type:s.type,sdp:s.sdp},s.type==="offer"?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(c).forEach(function(v){var T=c[v];if(T.getTracks().length){if(o.remoteStreams.indexOf(T)===-1){o.remoteStreams.push(T);var b=new Event("addstream");b.stream=T,e.setTimeout(function(){o._dispatchEvent("addstream",b)})}l.forEach(function(A){var R=A[0],G=A[1];T.id===A[2].id&&i(o,R,G,[T])})}}),l.forEach(function(v){v[2]||i(o,v[0],v[1],[])}),e.setTimeout(function(){!(o&&o.transceivers)||o.transceivers.forEach(function(v){v.iceTransport&&v.iceTransport.state==="new"&&v.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),v.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},a.prototype.close=function(){this.transceivers.forEach(function(s){s.iceTransport&&s.iceTransport.stop(),s.dtlsTransport&&s.dtlsTransport.stop(),s.rtpSender&&s.rtpSender.stop(),s.rtpReceiver&&s.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},a.prototype._updateSignalingState=function(s){this.signalingState=s;var o=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",o)},a.prototype._maybeFireNegotiationNeeded=function(){var s=this;this.signalingState!=="stable"||this.needNegotiation===!0||(this.needNegotiation=!0,e.setTimeout(function(){if(s.needNegotiation){s.needNegotiation=!1;var o=new Event("negotiationneeded");s._dispatchEvent("negotiationneeded",o)}},0))},a.prototype._updateIceConnectionState=function(){var s,o={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(l){l.iceTransport&&!l.rejected&&o[l.iceTransport.state]++}),s="new",o.failed>0?s="failed":o.checking>0?s="checking":o.disconnected>0?s="disconnected":o.new>0?s="new":o.connected>0?s="connected":o.completed>0&&(s="completed"),s!==this.iceConnectionState){this.iceConnectionState=s;var c=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",c)}},a.prototype._updateConnectionState=function(){var s,o={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(l){l.iceTransport&&l.dtlsTransport&&!l.rejected&&(o[l.iceTransport.state]++,o[l.dtlsTransport.state]++)}),o.connected+=o.completed,s="new",o.failed>0?s="failed":o.connecting>0?s="connecting":o.disconnected>0?s="disconnected":o.new>0?s="new":o.connected>0&&(s="connected"),s!==this.connectionState){this.connectionState=s;var c=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",c)}},a.prototype.createOffer=function(){var s=this;if(s._isClosed)return Promise.reject(D("InvalidStateError","Can not call createOffer after close"));var o=s.transceivers.filter(function(f){return f.kind==="audio"}).length,c=s.transceivers.filter(function(f){return f.kind==="video"}).length,l=arguments[0];if(l){if(l.mandatory||l.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");l.offerToReceiveAudio!==void 0&&(l.offerToReceiveAudio===!0?o=1:l.offerToReceiveAudio===!1?o=0:o=l.offerToReceiveAudio),l.offerToReceiveVideo!==void 0&&(l.offerToReceiveVideo===!0?c=1:l.offerToReceiveVideo===!1?c=0:c=l.offerToReceiveVideo)}for(s.transceivers.forEach(function(f){f.kind==="audio"?(o--,o<0&&(f.wantReceive=!1)):f.kind==="video"&&(c--,c<0&&(f.wantReceive=!1))});o>0||c>0;)o>0&&(s._createTransceiver("audio"),o--),c>0&&(s._createTransceiver("video"),c--);var d=C.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.transceivers.forEach(function(f,g){var P=f.track,v=f.kind,T=f.mid||C.generateIdentifier();f.mid=T,f.iceGatherer||(f.iceGatherer=s._createIceGatherer(g,s.usingBundle));var b=e.RTCRtpSender.getCapabilities(v);t<15019&&(b.codecs=b.codecs.filter(function(R){return R.name!=="rtx"})),b.codecs.forEach(function(R){R.name==="H264"&&R.parameters["level-asymmetry-allowed"]===void 0&&(R.parameters["level-asymmetry-allowed"]="1"),f.remoteCapabilities&&f.remoteCapabilities.codecs&&f.remoteCapabilities.codecs.forEach(function(G){R.name.toLowerCase()===G.name.toLowerCase()&&R.clockRate===G.clockRate&&(R.preferredPayloadType=G.payloadType)})}),b.headerExtensions.forEach(function(R){var G=f.remoteCapabilities&&f.remoteCapabilities.headerExtensions||[];G.forEach(function(I){R.uri===I.uri&&(R.id=I.id)})});var A=f.sendEncodingParameters||[{ssrc:(2*g+1)*1001}];P&&t>=15019&&v==="video"&&!A[0].rtx&&(A[0].rtx={ssrc:A[0].ssrc+1}),f.wantReceive&&(f.rtpReceiver=new e.RTCRtpReceiver(f.dtlsTransport,v)),f.localCapabilities=b,f.sendEncodingParameters=A}),s._config.bundlePolicy!=="max-compat"&&(d+="a=group:BUNDLE "+s.transceivers.map(function(f){return f.mid}).join(" ")+`\r
`),d+=`a=ice-options:trickle\r
`,s.transceivers.forEach(function(f,g){d+=ht(f,f.localCapabilities,"offer",f.stream,s._dtlsRole),d+=`a=rtcp-rsize\r
`,f.iceGatherer&&s.iceGatheringState!=="new"&&(g===0||!s.usingBundle)&&(f.iceGatherer.getLocalCandidates().forEach(function(P){P.component=1,d+="a="+C.writeCandidate(P)+`\r
`}),f.iceGatherer.state==="completed"&&(d+=`a=end-of-candidates\r
`))});var h=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(h)},a.prototype.createAnswer=function(){var s=this;if(s._isClosed)return Promise.reject(D("InvalidStateError","Can not call createAnswer after close"));if(!(s.signalingState==="have-remote-offer"||s.signalingState==="have-local-pranswer"))return Promise.reject(D("InvalidStateError","Can not call createAnswer in signalingState "+s.signalingState));var o=C.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.usingBundle&&(o+="a=group:BUNDLE "+s.transceivers.map(function(d){return d.mid}).join(" ")+`\r
`),o+=`a=ice-options:trickle\r
`;var c=C.getMediaSections(s._remoteDescription.sdp).length;s.transceivers.forEach(function(d,h){if(!(h+1>c)){if(d.rejected){d.kind==="application"?d.protocol==="DTLS/SCTP"?o+=`m=application 0 DTLS/SCTP 5000\r
`:o+="m=application 0 "+d.protocol+` webrtc-datachannel\r
`:d.kind==="audio"?o+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:d.kind==="video"&&(o+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),o+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+d.mid+`\r
`;return}if(d.stream){var f;d.kind==="audio"?f=d.stream.getAudioTracks()[0]:d.kind==="video"&&(f=d.stream.getVideoTracks()[0]),f&&t>=15019&&d.kind==="video"&&!d.sendEncodingParameters[0].rtx&&(d.sendEncodingParameters[0].rtx={ssrc:d.sendEncodingParameters[0].ssrc+1})}var g=fe(d.localCapabilities,d.remoteCapabilities),P=g.codecs.filter(function(v){return v.name.toLowerCase()==="rtx"}).length;!P&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx,o+=ht(d,g,"answer",d.stream,s._dtlsRole),d.rtcpParameters&&d.rtcpParameters.reducedSize&&(o+=`a=rtcp-rsize\r
`)}});var l=new e.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(l)},a.prototype.addIceCandidate=function(s){var o=this,c;return s&&!(s.sdpMLineIndex!==void 0||s.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(l,d){if(o._remoteDescription)if(!s||s.candidate==="")for(var h=0;h<o.transceivers.length&&!(!o.transceivers[h].rejected&&(o.transceivers[h].iceTransport.addRemoteCandidate({}),c=C.getMediaSections(o._remoteDescription.sdp),c[h]+=`a=end-of-candidates\r
`,o._remoteDescription.sdp=C.getDescription(o._remoteDescription.sdp)+c.join(""),o.usingBundle));h++);else{var f=s.sdpMLineIndex;if(s.sdpMid){for(var g=0;g<o.transceivers.length;g++)if(o.transceivers[g].mid===s.sdpMid){f=g;break}}var P=o.transceivers[f];if(P){if(P.rejected)return l();var v=Object.keys(s.candidate).length>0?C.parseCandidate(s.candidate):{};if(v.protocol==="tcp"&&(v.port===0||v.port===9)||v.component&&v.component!==1)return l();if((f===0||f>0&&P.iceTransport!==o.transceivers[0].iceTransport)&&!Me(P.iceTransport,v))return d(D("OperationError","Can not add ICE candidate"));var T=s.candidate.trim();T.indexOf("a=")===0&&(T=T.substr(2)),c=C.getMediaSections(o._remoteDescription.sdp),c[f]+="a="+(v.type?T:"end-of-candidates")+`\r
`,o._remoteDescription.sdp=C.getDescription(o._remoteDescription.sdp)+c.join("")}else return d(D("OperationError","Can not add ICE candidate"))}else return d(D("InvalidStateError","Can not add ICE candidate without a remote description"));l()})},a.prototype.getStats=function(s){if(s&&s instanceof e.MediaStreamTrack){var o=null;if(this.transceivers.forEach(function(l){l.rtpSender&&l.rtpSender.track===s?o=l.rtpSender:l.rtpReceiver&&l.rtpReceiver.track===s&&(o=l.rtpReceiver)}),!o)throw D("InvalidAccessError","Invalid selector.");return o.getStats()}var c=[];return this.transceivers.forEach(function(l){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(d){l[d]&&c.push(l[d].getStats())})}),Promise.all(c).then(function(l){var d=new Map;return l.forEach(function(h){h.forEach(function(f){d.set(f.id,f)})}),d})};var u=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];u.forEach(function(s){var o=e[s];if(o&&o.prototype&&o.prototype.getStats){var c=o.prototype.getStats;o.prototype.getStats=function(){return c.apply(this).then(function(l){var d=new Map;return Object.keys(l).forEach(function(h){l[h].type=Sr(l[h]),d.set(h,l[h])}),d})}}});var p=["createOffer","createAnswer"];return p.forEach(function(s){var o=a.prototype[s];a.prototype[s]=function(){var c=arguments;return typeof c[0]=="function"||typeof c[1]=="function"?o.apply(this,[arguments[2]]).then(function(l){typeof c[0]=="function"&&c[0].apply(null,[l])},function(l){typeof c[1]=="function"&&c[1].apply(null,[l])}):o.apply(this,arguments)}}),p=["setLocalDescription","setRemoteDescription","addIceCandidate"],p.forEach(function(s){var o=a.prototype[s];a.prototype[s]=function(){var c=arguments;return typeof c[1]=="function"||typeof c[2]=="function"?o.apply(this,arguments).then(function(){typeof c[1]=="function"&&c[1].apply(null)},function(l){typeof c[2]=="function"&&c[2].apply(null,[l])}):o.apply(this,arguments)}}),["getStats"].forEach(function(s){var o=a.prototype[s];a.prototype[s]=function(){var c=arguments;return typeof c[1]=="function"?o.apply(this,arguments).then(function(){typeof c[1]=="function"&&c[1].apply(null)}):o.apply(this,arguments)}}),a};function vt(e){const t=e&&e.navigator,r=function(i){return{name:{PermissionDeniedError:"NotAllowedError"}[i.name]||i.name,message:i.message,constraint:i.constraint,toString(){return this.name}}},n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(i){return n(i).catch(a=>Promise.reject(r(a)))}}function gt(e){"getDisplayMedia"in e.navigator&&(!e.navigator.mediaDevices||e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function Ne(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(i){return i}),e.RTCSessionDescription||(e.RTCSessionDescription=function(i){return i}),t.version<15025)){const n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(i){n.set.call(this,i);const a=new Event("enabled");a.enabled=i,this.dispatchEvent(a)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new e.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const r=_r(e,t.version);e.RTCPeerConnection=function(i){return i&&i.iceServers&&(i.iceServers=yr(i.iceServers,t.version),ke("ICE servers after filtering:",i.iceServers)),new r(i)},e.RTCPeerConnection.prototype=r.prototype}function Ct(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var Tt=Object.freeze({__proto__:null,shimPeerConnection:Ne,shimReplaceTrack:Ct,shimGetUserMedia:vt,shimGetDisplayMedia:gt});function yt(e,t){const r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(i,a,u){de("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(i).then(a,u)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const i=function(u,p,s){p in u&&!(s in u)&&(u[s]=u[p],delete u[p])},a=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),i(u.audio,"autoGainControl","mozAutoGainControl"),i(u.audio,"noiseSuppression","mozNoiseSuppression")),a(u)},n&&n.prototype.getSettings){const u=n.prototype.getSettings;n.prototype.getSettings=function(){const p=u.apply(this,arguments);return i(p,"mozAutoGainControl","autoGainControl"),i(p,"mozNoiseSuppression","noiseSuppression"),p}}if(n&&n.prototype.applyConstraints){const u=n.prototype.applyConstraints;n.prototype.applyConstraints=function(p){return this.kind==="audio"&&typeof p=="object"&&(p=JSON.parse(JSON.stringify(p)),i(p,"autoGainControl","mozAutoGainControl"),i(p,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[p])}}}}function Pr(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return n.video===!0?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function Et(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ie(e,t){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=e.RTCPeerConnection.prototype[i],u={[i](){return arguments[0]=new(i==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};e.RTCPeerConnection.prototype[i]=u[i]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[a,u,p]=arguments;return n.apply(this,[a||null]).then(s=>{if(t.version<53&&!u)try{s.forEach(o=>{o.type=r[o.type]||o.type})}catch(o){if(o.name!=="TypeError")throw o;s.forEach((c,l)=>{s.set(l,Object.assign({},c,{type:r[c.type]||c.type}))})}return s}).then(u,p)}}function St(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=t.apply(this,[]);return i.forEach(a=>a._pc=this),i});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Rt(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const n=t.apply(this,[]);return n.forEach(i=>i._pc=this),n}),k(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function _t(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(r){de("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&r.getTracks().includes(n.track)&&this.removeTrack(n)})})}function Pt(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function bt(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const n=arguments[1],i=n&&"sendEncodings"in n;i&&n.sendEncodings.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=t.apply(this,arguments);if(i){const{sender:u}=a,p=u.getParameters();(!("encodings"in p)||p.encodings.length===1&&Object.keys(p.encodings[0]).length===0)&&(p.encodings=n.sendEncodings,u.sendEncodings=n.sendEncodings,this.setParametersPromises.push(u.setParameters(p).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return a})}function At(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const n=t.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function Ot(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function kt(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var Dt=Object.freeze({__proto__:null,shimOnTrack:Et,shimPeerConnection:Ie,shimSenderGetStats:St,shimReceiverGetStats:Rt,shimRemoveStream:_t,shimRTCDataChannel:Pt,shimAddTransceiver:bt,shimGetParameters:At,shimCreateOffer:Ot,shimCreateAnswer:kt,shimGetUserMedia:yt,shimGetDisplayMedia:Pr});function xt(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(i=>t.call(this,i,n)),n.getVideoTracks().forEach(i=>t.call(this,i,n))},e.RTCPeerConnection.prototype.addTrack=function(n,...i){return i&&i.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(r){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(r);if(n===-1)return;this._localStreams.splice(n,1);const i=r.getTracks();this.getSenders().forEach(a=>{i.includes(a.track)&&this.removeTrack(a)})})}}function Mt(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,this.dispatchEvent(a)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(a=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(a)>=0)return;n._remoteStreams.push(a);const u=new Event("addstream");u.stream=a,n.dispatchEvent(u)})}),t.apply(n,arguments)}}}function Nt(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,u=t.addIceCandidate;t.createOffer=function(o,c){const l=arguments.length>=2?arguments[2]:arguments[0],d=r.apply(this,[l]);return c?(d.then(o,c),Promise.resolve()):d},t.createAnswer=function(o,c){const l=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[l]);return c?(d.then(o,c),Promise.resolve()):d};let p=function(s,o,c){const l=i.apply(this,[s]);return c?(l.then(o,c),Promise.resolve()):l};t.setLocalDescription=p,p=function(s,o,c){const l=a.apply(this,[s]);return c?(l.then(o,c),Promise.resolve()):l},t.setRemoteDescription=p,p=function(s,o,c){const l=u.apply(this,[s]);return c?(l.then(o,c),Promise.resolve()):l},t.addIceCandidate=p}function It(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=i=>n(Lt(i))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(n,i,a){t.mediaDevices.getUserMedia(n).then(i,a)}.bind(t))}function Lt(e){return e&&e.video!==void 0?Object.assign({},e,{video:tt(e.video)}):e}function jt(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(n,i){if(n&&n.iceServers){const a=[];for(let u=0;u<n.iceServers.length;u++){let p=n.iceServers[u];!p.hasOwnProperty("urls")&&p.hasOwnProperty("url")?(de("RTCIceServer.url","RTCIceServer.urls"),p=JSON.parse(JSON.stringify(p)),p.urls=p.url,delete p.url,a.push(p)):a.push(n.iceServers[u])}n.iceServers=a}return new t(n,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return t.generateCertificate}})}function Gt(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Bt(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const i=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio"),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const a=this.getTransceivers().find(u=>u.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):n.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video")}return t.apply(this,arguments)}}function Ft(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Ut=Object.freeze({__proto__:null,shimLocalStreamsAPI:xt,shimRemoteStreamsAPI:Mt,shimCallbacksAPI:Nt,shimGetUserMedia:It,shimConstraints:Lt,shimRTCIceServerUrls:jt,shimTrackEventTransceiver:Gt,shimCreateOfferLegacy:Bt,shimAudioContext:Ft});function he(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substr(2)),n.candidate&&n.candidate.length){const i=new t(n),a=C.parseCandidate(n.candidate),u=Object.assign(i,a);return u.toJSON=function(){return{candidate:u.candidate,sdpMid:u.sdpMid,sdpMLineIndex:u.sdpMLineIndex,usernameFragment:u.usernameFragment}},u}return new t(n)},e.RTCIceCandidate.prototype=t.prototype,k(e,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new e.RTCIceCandidate(r.candidate),writable:"false"}),r))}function ae(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const r=function(p){if(!p||!p.sdp)return!1;const s=C.splitSections(p.sdp);return s.shift(),s.some(o=>{const c=C.parseMLine(o);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},n=function(p){const s=p.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(s===null||s.length<2)return-1;const o=parseInt(s[1],10);return o!==o?-1:o},i=function(p){let s=65536;return t.browser==="firefox"&&(t.version<57?p===-1?s=16384:s=2147483637:t.version<60?s=t.version===57?65535:65536:s=2147483637),s},a=function(p,s){let o=65536;t.browser==="firefox"&&t.version===57&&(o=65535);const c=C.matchPrefix(p.sdp,"a=max-message-size:");return c.length>0?o=parseInt(c[0].substr(19),10):t.browser==="firefox"&&s!==-1&&(o=2147483637),o},u=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:s}=this.getConfiguration();s==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const s=n(arguments[0]),o=i(s),c=a(arguments[0],s);let l;o===0&&c===0?l=Number.POSITIVE_INFINITY:o===0||c===0?l=Math.max(o,c):l=Math.min(o,c);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return l}}),this._sctp=d}return u.apply(this,arguments)}}function se(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(n,i){const a=n.send;n.send=function(){const p=arguments[0],s=p.length||p.size||p.byteLength;if(n.readyState==="open"&&i.sctp&&s>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return a.apply(n,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=r.apply(this,arguments);return t(i,this),i},k(e,"datachannel",n=>(t(n.channel,n.target),n))}function Le(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const n=t[r];t[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const a=i.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const u=new Event("connectionstatechange",i);a.dispatchEvent(u)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function je(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=i.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:a}):i.sdp=a}return r.apply(this,arguments)}}function me(e,t){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const r=e.RTCPeerConnection.prototype.addIceCandidate;!r||r.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}var br=Object.freeze({__proto__:null,shimRTCIceCandidate:he,shimMaxMessageSize:ae,shimSendThrowTypeError:se,shimConnectionState:Le,removeExtmapAllowMixed:je,shimAddIceCandidateNullOrEmpty:me});function Ar({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const r=ke,n=Cr(e),i={browserDetails:n,commonShim:br,extractVersion:U,disableLog:E,disableWarnings:O};switch(n.browser){case"chrome":if(!ft||!xe||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;if(n.version===null)return r("Chrome shim can not determine version, not shimming."),i;r("adapter.js shimming chrome."),i.browserShim=ft,me(e,n),it(e,n),at(e),xe(e,n),st(e),lt(e,n),ot(e),ct(e),ut(e),dt(e,n),he(e),Le(e),ae(e,n),se(e),je(e,n);break;case"firefox":if(!Dt||!Ie||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),i.browserShim=Dt,me(e,n),yt(e,n),Ie(e,n),Et(e),_t(e),St(e),Rt(e),Pt(e),bt(e),At(e),Ot(e),kt(e),he(e),Le(e),ae(e,n),se(e);break;case"edge":if(!Tt||!Ne||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),i;r("adapter.js shimming edge."),i.browserShim=Tt,vt(e),gt(e),Ne(e,n),Ct(e),ae(e,n),se(e);break;case"safari":if(!Ut||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),i.browserShim=Ut,me(e,n),jt(e),Bt(e),Nt(e),xt(e),Mt(e),Gt(e),It(e),Ft(e),he(e),ae(e,n),se(e),je(e,n);break;default:r("Unsupported browser!");break}return i}Ar({window:typeof window>"u"?void 0:window});class ve{constructor(t){if(!Object.values(B).some(r=>r===t))throw new TypeError("Invalid source.");this.source=t,this.deviceId=void 0}}class oe{constructor(t){if(!Object.values(_).some(r=>r===t))throw new TypeError("Invalid source.");this.source=t,this.deviceId=void 0,this.resolution=void 0,this.frameRate=void 0}}class ge{constructor(t=!1,r=!1){this.audio=t,this.video=r}}function Ce(e){return typeof e.video=="object"&&e.video.source===_.SCREENCAST}class Te{static createMediaStream(t){if(typeof t!="object"||!t.audio&&!t.video)return Promise.reject(new TypeError("Invalid constrains"));if(!Ce(t)&&typeof t.audio=="object"&&t.audio.source===B.SCREENCAST)return Promise.reject(new TypeError("Cannot share screen without video."));if(Ce(t)&&!Ae()&&!ie())return Promise.reject(new TypeError("Screen sharing only supports Chrome and Firefox."));if(Ce(t)&&typeof t.audio=="object"&&t.audio.source!==B.SCREENCAST)return Promise.reject(new TypeError("Cannot capture video from screen cast while capture audio from other source."));if(!t.audio&&!t.video)return Promise.reject(new TypeError("At least one of audio and video must be requested."));const r=Object.create({});return typeof t.audio=="object"&&t.audio.source===B.MIC?(r.audio=Object.create({}),le()?r.audio.deviceId=t.audio.deviceId:r.audio.deviceId={exact:t.audio.deviceId}):t.audio.source===B.SCREENCAST?r.audio=!0:r.audio=t.audio,typeof t.video=="object"?(r.video=Object.create({}),typeof t.video.frameRate=="number"&&(r.video.frameRate=t.video.frameRate),t.video.resolution&&t.video.resolution.width&&t.video.resolution.height&&(t.video.source===_.SCREENCAST?(r.video.width=t.video.resolution.width,r.video.height=t.video.resolution.height):(r.video.width=Object.create({}),r.video.width.exact=t.video.resolution.width,r.video.height=Object.create({}),r.video.height.exact=t.video.resolution.height)),typeof t.video.deviceId=="string"&&(r.video.deviceId={exact:t.video.deviceId}),ie()&&t.video.source===_.SCREENCAST&&(r.video.mediaSource="screen")):r.video=t.video,Ce(t)?navigator.mediaDevices.getDisplayMedia(r):navigator.mediaDevices.getUserMedia(r)}}var Or=Object.freeze({__proto__:null,AudioTrackConstraints:ve,VideoTrackConstraints:oe,StreamConstraints:ge,MediaStreamFactory:Te,AudioSourceInfo:B,VideoSourceInfo:_,TrackKind:Oe,Resolution:X});let Ge,Be;function kr(){Ge=console.log,Be=console.error}function F(e,...t){Ge&&Ge(e,...t)}function J(e,...t){Be&&Be(e,...t)}class Dr{constructor(t){this.listener={},this.type=t|""}on(t,r){return this.listener[t]||(this.listener[t]=[]),this.listener[t].push(r),!0}off(t,r){if(this.listener[t]){var n=this.listener[t].indexOf(r);return n>-1&&this.listener[t].splice(n,1),!0}return!1}offAll(){this.listener={}}dispatch(t,r){return this.listener[t]?(this.listener[t].map(n=>{n.apply(null,[r])}),!0):!1}}var Wt=function(t,r){return function(){for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];return t.apply(r,i)}},Fe=Object.prototype.toString,Ue=function(e){return function(t){var r=Fe.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())}}(Object.create(null));function q(e){return e=e.toLowerCase(),function(r){return Ue(r)===e}}function We(e){return Array.isArray(e)}function ye(e){return typeof e>"u"}function xr(e){return e!==null&&!ye(e)&&e.constructor!==null&&!ye(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var zt=q("ArrayBuffer");function Mr(e){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&zt(e.buffer),t}function Nr(e){return typeof e=="string"}function Ir(e){return typeof e=="number"}function Ht(e){return e!==null&&typeof e=="object"}function Ee(e){if(Ue(e)!=="object")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}var Lr=q("Date"),jr=q("File"),Gr=q("Blob"),Br=q("FileList");function ze(e){return Fe.call(e)==="[object Function]"}function Fr(e){return Ht(e)&&ze(e.pipe)}function Ur(e){var t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||Fe.call(e)===t||ze(e.toString)&&e.toString()===t)}var Wr=q("URLSearchParams");function zr(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Hr(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function He(e,t){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),We(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function Ve(){var e={};function t(i,a){Ee(e[a])&&Ee(i)?e[a]=Ve(e[a],i):Ee(i)?e[a]=Ve({},i):We(i)?e[a]=i.slice():e[a]=i}for(var r=0,n=arguments.length;r<n;r++)He(arguments[r],t);return e}function Vr(e,t,r){return He(t,function(i,a){r&&typeof i=="function"?e[a]=Wt(i,r):e[a]=i}),e}function Jr(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function qr(e,t,r,n){e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,r&&Object.assign(e.prototype,r)}function $r(e,t,r){var n,i,a,u={};t=t||{};do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)a=n[i],u[a]||(t[a]=e[a],u[a]=!0);e=Object.getPrototypeOf(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t}function Zr(e,t,r){e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;var n=e.indexOf(t,r);return n!==-1&&n===r}function Xr(e){if(!e)return null;var t=e.length;if(ye(t))return null;for(var r=new Array(t);t-- >0;)r[t]=e[t];return r}var Kr=function(e){return function(t){return e&&t instanceof e}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),m={isArray:We,isArrayBuffer:zt,isBuffer:xr,isFormData:Ur,isArrayBufferView:Mr,isString:Nr,isNumber:Ir,isObject:Ht,isPlainObject:Ee,isUndefined:ye,isDate:Lr,isFile:jr,isBlob:Gr,isFunction:ze,isStream:Fr,isURLSearchParams:Wr,isStandardBrowserEnv:Hr,forEach:He,merge:Ve,extend:Vr,trim:zr,stripBOM:Jr,inherits:qr,toFlatObject:$r,kindOf:Ue,kindOfTest:q,endsWith:Zr,toArray:Xr,isTypedArray:Kr,isFileList:Br};function Vt(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Jt=function(t,r,n){if(!r)return t;var i;if(n)i=n(r);else if(m.isURLSearchParams(r))i=r.toString();else{var a=[];m.forEach(r,function(s,o){s===null||typeof s>"u"||(m.isArray(s)?o=o+"[]":s=[s],m.forEach(s,function(l){m.isDate(l)?l=l.toISOString():m.isObject(l)&&(l=JSON.stringify(l)),a.push(Vt(o)+"="+Vt(l))}))}),i=a.join("&")}if(i){var u=t.indexOf("#");u!==-1&&(t=t.slice(0,u)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t};function Se(){this.handlers=[]}Se.prototype.use=function(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1},Se.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},Se.prototype.forEach=function(t){m.forEach(this.handlers,function(n){n!==null&&t(n)})};var qt=Se,$t=function(t,r){m.forEach(t,function(i,a){a!==r&&a.toUpperCase()===r.toUpperCase()&&(t[r]=i,delete t[a])})};function Q(e,t,r,n,i){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i)}m.inherits(Q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Zt=Q.prototype,Xt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(e){Xt[e]={value:e}}),Object.defineProperties(Q,Xt),Object.defineProperty(Zt,"isAxiosError",{value:!0}),Q.from=function(e,t,r,n,i,a){var u=Object.create(Zt);return m.toFlatObject(e,u,function(s){return s!==Error.prototype}),Q.call(u,e.message,t,r,n,i),u.name=e.name,a&&Object.assign(u,a),u};var S=Q,Kt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};function Qr(e,t){t=t||new FormData;var r=[];function n(a){return a===null?"":m.isDate(a)?a.toISOString():m.isArrayBuffer(a)||m.isTypedArray(a)?typeof Blob=="function"?new Blob([a]):Buffer.from(a):a}function i(a,u){if(m.isPlainObject(a)||m.isArray(a)){if(r.indexOf(a)!==-1)throw Error("Circular reference detected in "+u);r.push(a),m.forEach(a,function(s,o){if(!m.isUndefined(s)){var c=u?u+"."+o:o,l;if(s&&!u&&typeof s=="object"){if(m.endsWith(o,"{}"))s=JSON.stringify(s);else if(m.endsWith(o,"[]")&&(l=m.toArray(s))){l.forEach(function(d){!m.isUndefined(d)&&t.append(c,n(d))});return}}i(s,c)}}),r.pop()}else t.append(u,n(a))}return i(e),t}var Qt=Qr,Yr=function(t,r,n){var i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):r(new S("Request failed with status code "+n.status,[S.ERR_BAD_REQUEST,S.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))},wr=m.isStandardBrowserEnv()?function(){return{write:function(r,n,i,a,u,p){var s=[];s.push(r+"="+encodeURIComponent(n)),m.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),m.isString(a)&&s.push("path="+a),m.isString(u)&&s.push("domain="+u),p===!0&&s.push("secure"),document.cookie=s.join("; ")},read:function(r){var n=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),en=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},tn=function(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t},Yt=function(t,r){return t&&!en(r)?tn(t,r):r},rn=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],nn=function(t){var r={},n,i,a;return t&&m.forEach(t.split(`
`),function(p){if(a=p.indexOf(":"),n=m.trim(p.substr(0,a)).toLowerCase(),i=m.trim(p.substr(a+1)),n){if(r[n]&&rn.indexOf(n)>=0)return;n==="set-cookie"?r[n]=(r[n]?r[n]:[]).concat([i]):r[n]=r[n]?r[n]+", "+i:i}}),r},an=m.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),n;function i(a){var u=a;return t&&(r.setAttribute("href",u),u=r.href),r.setAttribute("href",u),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=i(window.location.href),function(u){var p=m.isString(u)?i(u):u;return p.protocol===n.protocol&&p.host===n.host}}():function(){return function(){return!0}}();function wt(e){S.call(this,e==null?"canceled":e,S.ERR_CANCELED),this.name="CanceledError"}m.inherits(wt,S,{__CANCEL__:!0});var Re=wt,sn=function(t){var r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""},er=function(t){return new Promise(function(n,i){var a=t.data,u=t.headers,p=t.responseType,s;function o(){t.cancelToken&&t.cancelToken.unsubscribe(s),t.signal&&t.signal.removeEventListener("abort",s)}m.isFormData(a)&&m.isStandardBrowserEnv()&&delete u["Content-Type"];var c=new XMLHttpRequest;if(t.auth){var l=t.auth.username||"",d=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";u.Authorization="Basic "+btoa(l+":"+d)}var h=Yt(t.baseURL,t.url);c.open(t.method.toUpperCase(),Jt(h,t.params,t.paramsSerializer),!0),c.timeout=t.timeout;function f(){if(!!c){var v="getAllResponseHeaders"in c?nn(c.getAllResponseHeaders()):null,T=!p||p==="text"||p==="json"?c.responseText:c.response,b={data:T,status:c.status,statusText:c.statusText,headers:v,config:t,request:c};Yr(function(R){n(R),o()},function(R){i(R),o()},b),c=null}}if("onloadend"in c?c.onloadend=f:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(f)},c.onabort=function(){!c||(i(new S("Request aborted",S.ECONNABORTED,t,c)),c=null)},c.onerror=function(){i(new S("Network Error",S.ERR_NETWORK,t,c,c)),c=null},c.ontimeout=function(){var T=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",b=t.transitional||Kt;t.timeoutErrorMessage&&(T=t.timeoutErrorMessage),i(new S(T,b.clarifyTimeoutError?S.ETIMEDOUT:S.ECONNABORTED,t,c)),c=null},m.isStandardBrowserEnv()){var g=(t.withCredentials||an(h))&&t.xsrfCookieName?wr.read(t.xsrfCookieName):void 0;g&&(u[t.xsrfHeaderName]=g)}"setRequestHeader"in c&&m.forEach(u,function(T,b){typeof a>"u"&&b.toLowerCase()==="content-type"?delete u[b]:c.setRequestHeader(b,T)}),m.isUndefined(t.withCredentials)||(c.withCredentials=!!t.withCredentials),p&&p!=="json"&&(c.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&c.addEventListener("progress",t.onDownloadProgress),typeof t.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(s=function(v){!c||(i(!v||v&&v.type?new Re:v),c.abort(),c=null)},t.cancelToken&&t.cancelToken.subscribe(s),t.signal&&(t.signal.aborted?s():t.signal.addEventListener("abort",s))),a||(a=null);var P=sn(h);if(P&&["http","https","file"].indexOf(P)===-1){i(new S("Unsupported protocol "+P+":",S.ERR_BAD_REQUEST,t));return}c.send(a)})},on=null,cn={"Content-Type":"application/x-www-form-urlencoded"};function tr(e,t){!m.isUndefined(e)&&m.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function un(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=er),e}function pn(e,t,r){if(m.isString(e))try{return(t||JSON.parse)(e),m.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}var _e={transitional:Kt,adapter:un(),transformRequest:[function(t,r){if($t(r,"Accept"),$t(r,"Content-Type"),m.isFormData(t)||m.isArrayBuffer(t)||m.isBuffer(t)||m.isStream(t)||m.isFile(t)||m.isBlob(t))return t;if(m.isArrayBufferView(t))return t.buffer;if(m.isURLSearchParams(t))return tr(r,"application/x-www-form-urlencoded;charset=utf-8"),t.toString();var n=m.isObject(t),i=r&&r["Content-Type"],a;if((a=m.isFileList(t))||n&&i==="multipart/form-data"){var u=this.env&&this.env.FormData;return Qt(a?{"files[]":t}:t,u&&new u)}else if(n||i==="application/json")return tr(r,"application/json"),pn(t);return t}],transformResponse:[function(t){var r=this.transitional||_e.transitional,n=r&&r.silentJSONParsing,i=r&&r.forcedJSONParsing,a=!n&&this.responseType==="json";if(a||i&&m.isString(t)&&t.length)try{return JSON.parse(t)}catch(u){if(a)throw u.name==="SyntaxError"?S.from(u,S.ERR_BAD_RESPONSE,this,null,this.response):u}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:on},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};m.forEach(["delete","get","head"],function(t){_e.headers[t]={}}),m.forEach(["post","put","patch"],function(t){_e.headers[t]=m.merge(cn)});var Je=_e,qe=function(t,r,n){var i=this||Je;return m.forEach(n,function(u){t=u.call(i,t,r)}),t},rr=function(t){return!!(t&&t.__CANCEL__)};function $e(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Re}var nr=function(t){$e(t),t.headers=t.headers||{},t.data=qe.call(t,t.data,t.headers,t.transformRequest),t.headers=m.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),m.forEach(["delete","get","head","post","put","patch","common"],function(i){delete t.headers[i]});var r=t.adapter||Je.adapter;return r(t).then(function(i){return $e(t),i.data=qe.call(t,i.data,i.headers,t.transformResponse),i},function(i){return rr(i)||($e(t),i&&i.response&&(i.response.data=qe.call(t,i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)})},ce=function(t,r){r=r||{};var n={};function i(c,l){return m.isPlainObject(c)&&m.isPlainObject(l)?m.merge(c,l):m.isPlainObject(l)?m.merge({},l):m.isArray(l)?l.slice():l}function a(c){if(m.isUndefined(r[c])){if(!m.isUndefined(t[c]))return i(void 0,t[c])}else return i(t[c],r[c])}function u(c){if(!m.isUndefined(r[c]))return i(void 0,r[c])}function p(c){if(m.isUndefined(r[c])){if(!m.isUndefined(t[c]))return i(void 0,t[c])}else return i(void 0,r[c])}function s(c){if(c in r)return i(t[c],r[c]);if(c in t)return i(void 0,t[c])}var o={url:u,method:u,data:u,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:s};return m.forEach(Object.keys(t).concat(Object.keys(r)),function(l){var d=o[l]||a,h=d(l);m.isUndefined(h)&&d!==s||(n[l]=h)}),n},ir={version:"0.27.2"},ln=ir.version,Ze={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){Ze[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var ar={};Ze.transitional=function(t,r,n){function i(a,u){return"[Axios v"+ln+"] Transitional option '"+a+"'"+u+(n?". "+n:"")}return function(a,u,p){if(t===!1)throw new S(i(u," has been removed"+(r?" in "+r:"")),S.ERR_DEPRECATED);return r&&!ar[u]&&(ar[u]=!0,console.warn(i(u," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,u,p):!0}};function dn(e,t,r){if(typeof e!="object")throw new S("options must be an object",S.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(e),i=n.length;i-- >0;){var a=n[i],u=t[a];if(u){var p=e[a],s=p===void 0||u(p,a,e);if(s!==!0)throw new S("option "+a+" must be "+s,S.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new S("Unknown option "+a,S.ERR_BAD_OPTION)}}var sr={assertOptions:dn,validators:Ze},Y=sr.validators;function w(e){this.defaults=e,this.interceptors={request:new qt,response:new qt}}w.prototype.request=function(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ce(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var n=r.transitional;n!==void 0&&sr.assertOptions(n,{silentJSONParsing:Y.transitional(Y.boolean),forcedJSONParsing:Y.transitional(Y.boolean),clarifyTimeoutError:Y.transitional(Y.boolean)},!1);var i=[],a=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(r)===!1||(a=a&&h.synchronous,i.unshift(h.fulfilled,h.rejected))});var u=[];this.interceptors.response.forEach(function(h){u.push(h.fulfilled,h.rejected)});var p;if(!a){var s=[nr,void 0];for(Array.prototype.unshift.apply(s,i),s=s.concat(u),p=Promise.resolve(r);s.length;)p=p.then(s.shift(),s.shift());return p}for(var o=r;i.length;){var c=i.shift(),l=i.shift();try{o=c(o)}catch(d){l(d);break}}try{p=nr(o)}catch(d){return Promise.reject(d)}for(;u.length;)p=p.then(u.shift(),u.shift());return p},w.prototype.getUri=function(t){t=ce(this.defaults,t);var r=Yt(t.baseURL,t.url);return Jt(r,t.params,t.paramsSerializer)},m.forEach(["delete","get","head","options"],function(t){w.prototype[t]=function(r,n){return this.request(ce(n||{},{method:t,url:r,data:(n||{}).data}))}}),m.forEach(["post","put","patch"],function(t){function r(n){return function(a,u,p){return this.request(ce(p||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:u}))}}w.prototype[t]=r(),w.prototype[t+"Form"]=r(!0)});var Pe=w;function ee(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(i){t=i});var r=this;this.promise.then(function(n){if(!!r._listeners){var i,a=r._listeners.length;for(i=0;i<a;i++)r._listeners[i](n);r._listeners=null}}),this.promise.then=function(n){var i,a=new Promise(function(u){r.subscribe(u),i=u}).then(n);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i){r.reason||(r.reason=new Re(i),t(r.reason))})}ee.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},ee.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]},ee.prototype.unsubscribe=function(t){if(!!this._listeners){var r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}},ee.source=function(){var t,r=new ee(function(i){t=i});return{token:r,cancel:t}};var fn=ee,hn=function(t){return function(n){return t.apply(null,n)}},mn=function(t){return m.isObject(t)&&t.isAxiosError===!0};function or(e){var t=new Pe(e),r=Wt(Pe.prototype.request,t);return m.extend(r,Pe.prototype,t),m.extend(r,t),r.create=function(i){return or(ce(e,i))},r}var N=or(Je);N.Axios=Pe,N.CanceledError=Re,N.CancelToken=fn,N.isCancel=rr,N.VERSION=ir.version,N.toFormData=Qt,N.AxiosError=S,N.Cancel=N.CanceledError,N.all=function(t){return Promise.all(t)},N.spread=hn,N.isAxiosError=mn;var cr=N,vn=N;cr.default=vn;var ur=cr;class gn extends Dr{constructor(t){super("RTCPusherPlayer"),this.TAG="[RTCPusherPlayer]";let r={element:"",debug:!1,zlmsdpUrl:"",simulcast:!1,useCamera:!0,audioEnable:!0,videoEnable:!0,recvOnly:!1,resolution:{w:0,h:0},usedatachannel:!1};this.options=Object.assign({},r,t),this.options.debug&&kr(),this.e={onicecandidate:this._onIceCandidate.bind(this),ontrack:this._onTrack.bind(this),onicecandidateerror:this._onIceCandidateError.bind(this),onconnectionstatechange:this._onconnectionstatechange.bind(this),ondatachannelopen:this._onDataChannelOpen.bind(this),ondatachannelmsg:this._onDataChannelMsg.bind(this),ondatachannelerr:this._onDataChannelErr.bind(this),ondatachannelclose:this._onDataChannelClose.bind(this)},this._remoteStream=null,this._localStream=null,this.pc=new RTCPeerConnection(null),this.pc.onicecandidate=this.e.onicecandidate,this.pc.onicecandidateerror=this.e.onicecandidateerror,this.pc.ontrack=this.e.ontrack,this.pc.onconnectionstatechange=this.e.onconnectionstatechange,this.datachannel=null,this.options.usedatachannel&&(this.datachannel=this.pc.createDataChannel("chat"),this.datachannel.onclose=this.e.ondatachannelclose,this.datachannel.onerror=this.e.ondatachannelerr,this.datachannel.onmessage=this.e.ondatachannelmsg,this.datachannel.onopen=this.e.ondatachannelopen),!this.options.recvOnly&&(this.options.audioEnable||this.options.videoEnable)?this.start():this.receive()}receive(){const t={direction:"recvonly",sendEncodings:[]},r={direction:"recvonly",sendEncodings:[]};this.options.videoEnable&&this.pc.addTransceiver("video",r),this.options.audioEnable&&this.pc.addTransceiver("audio",t),this.pc.createOffer().then(n=>{F(this.TAG,"offer:",n.sdp),this.pc.setLocalDescription(n).then(()=>{ur({method:"post",url:this.options.zlmsdpUrl,responseType:"json",data:n.sdp,headers:{"Content-Type":"text/plain;charset=utf-8"}}).then(i=>{let a=i.data;if(a.code!=0){this.dispatch(M.WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED,a);return}let u={};u.sdp=a.sdp,u.type="answer",F(this.TAG,"answer:",a.sdp),this.pc.setRemoteDescription(u).then(()=>{F(this.TAG,"set remote sucess")}).catch(p=>{J(this.TAG,p)})})})}).catch(n=>{J(this.TAG,n)})}start(){let t=!1,r=!1;this.options.useCamera?(this.options.videoEnable&&(t=new oe(_.CAMERA)),this.options.audioEnable&&(r=new ve(B.MIC))):this.options.videoEnable?(t=new oe(_.SCREENCAST),this.options.audioEnable&&(r=new ve(B.SCREENCAST))):this.options.audioEnable?r=new ve(B.MIC):J(this.TAG,"error paramter"),this.options.resolution.w!=0&&this.options.resolution.h!=0&&typeof t=="object"&&(t.resolution=new X(this.options.resolution.w,this.options.resolution.h)),Te.createMediaStream(new ge(r,t)).then(n=>{this._localStream=n,this.dispatch(M.WEBRTC_ON_LOCAL_STREAM,n);const i={direction:"sendrecv",sendEncodings:[]},a={direction:"sendrecv",sendEncodings:[]};this.options.simulcast&&n.getVideoTracks().length>0&&(a.sendEncodings=[{rid:"h",active:!0,maxBitrate:1e6},{rid:"m",active:!0,maxBitrate:5e5,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:2e5,scaleResolutionDownBy:4}]),this.options.audioEnable&&(n.getAudioTracks().length>0?this.pc.addTransceiver(n.getAudioTracks()[0],i):(i.direction="recvonly",this.pc.addTransceiver("audio",i))),this.options.videoEnable&&(n.getVideoTracks().length>0?this.pc.addTransceiver(n.getVideoTracks()[0],a):(a.direction="recvonly",this.pc.addTransceiver("video",a))),this.pc.createOffer().then(u=>{F(this.TAG,"offer:",u.sdp),this.pc.setLocalDescription(u).then(()=>{ur({method:"post",url:this.options.zlmsdpUrl,responseType:"json",data:u.sdp,headers:{"Content-Type":"text/plain;charset=utf-8"}}).then(p=>{let s=p.data;if(s.code!=0){this.dispatch(M.WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED,s);return}let o={};o.sdp=s.sdp,o.type="answer",F(this.TAG,"answer:",s.sdp),this.pc.setRemoteDescription(o).then(()=>{F(this.TAG,"set remote sucess")}).catch(c=>{J(this.TAG,c)})})})}).catch(u=>{J(this.TAG,u)})}).catch(n=>{this.dispatch(M.CAPTURE_STREAM_FAILED)})}_onIceCandidate(t){t.candidate&&F(`Remote ICE candidate: 
 `+t.candidate.candidate)}_onTrack(t){this.options.element&&t.streams&&t.streams.length>0?(this.options.element.srcObject=t.streams[0],this._remoteStream=t.streams[0],this.dispatch(M.WEBRTC_ON_REMOTE_STREAMS,t)):J("element pararm is failed")}_onIceCandidateError(t){this.dispatch(M.WEBRTC_ICE_CANDIDATE_ERROR,t)}_onconnectionstatechange(t){this.dispatch(M.WEBRTC_ON_CONNECTION_STATE_CHANGE,this.pc.connectionState)}_onDataChannelOpen(t){F(this.TAG,"ondatachannel open:",t),this.dispatch(M.WEBRTC_ON_DATA_CHANNEL_OPEN,t)}_onDataChannelMsg(t){F(this.TAG,"ondatachannel msg:",t),this.dispatch(M.WEBRTC_ON_DATA_CHANNEL_MSG,t)}_onDataChannelErr(t){F(this.TAG,"ondatachannel err:",t),this.dispatch(M.WEBRTC_ON_DATA_CHANNEL_ERR,t)}_onDataChannelClose(t){F(this.TAG,"ondatachannel close:",t),this.dispatch(M.WEBRTC_ON_DATA_CHANNEL_CLOSE,t)}sendMsg(t){this.datachannel!=null?this.datachannel.send(t):J(this.TAG,"data channel is null")}closeDataChannel(){this.datachannel&&(this.datachannel.close(),this.datachannel=null)}close(){this.closeDataChannel(),this.pc&&(this.pc.close(),this.pc=null),this.options&&(this.options=null),this._localStream&&this._localStream.getTracks().forEach((t,r)=>{t.stop()}),this._remoteStream&&this._remoteStream.getTracks().forEach((t,r)=>{t.stop()})}get remoteStream(){return this._remoteStream}get localStream(){return this._localStream}}const $=[{label:"4K(UHD)",width:3840,height:2160},{label:"1080p(FHD)",width:1920,height:1080},{label:"UXGA",width:1600,height:1200,ratio:"4:3"},{label:"720p(HD)",width:1280,height:720},{label:"SVGA",width:800,height:600},{label:"VGA",width:640,height:480},{label:"360p(nHD)",width:640,height:360},{label:"CIF",width:352,height:288},{label:"QVGA",width:320,height:240},{label:"QCIF",width:176,height:144},{label:"QQVGA",width:160,height:120}];function Cn(){return new Promise(function(e,t){let r=[],n=0,i=0;for(let a=0;a<$.length;++a){let u=new oe(_.CAMERA);u.resolution=new X($[a].width,$[a].height),Te.createMediaStream(new ge(!1,u)).then(p=>{r.push($[a]),n++,n+i==$.length&&e(r)}).catch(p=>{i++,n+i==$.length&&e(r)})}})}function Tn(){return $}function yn(e,t){return new Promise(function(r,n){let i=new oe(_.CAMERA);i.resolution=new X(e,t),Te.createMediaStream(new ge(!1,i)).then(a=>{r()}).catch(a=>{n(a)})})}console.log("build date:",V),console.log("version:",ne);const En=M,Sn=Or,Rn=gn,_n=Cn,Pn=Tn,bn=yn;return j.Endpoint=Rn,j.Events=En,j.GetAllScanResolution=Pn,j.GetSupportCameraResolutions=_n,j.Media=Sn,j.isSupportResolution=bn,Object.defineProperty(j,"__esModule",{value:!0}),j})({});const zn=j=>(Fn("data-v-c81b39d0"),j=j(),Un(),j),Hn={class:"conversation"},Vn=zn(()=>Z("video",{id:"video",autoplay:"",style:{width:"100%",height:"100%"}}," Your browser is too old which doesn't support HTML5 video. ",-1)),Jn=[Vn],qn=["onClick"],$n={class:"handUp"},Zn={setup(j){const M=xn(),ne=be(!1),V=be(!0),ie=be(null),Ae=()=>{ie.value.className.split(" ").indexOf("small")!=-1&&(V.value=!V.value)},le=be(null),B=()=>{le.value.className.split(" ").indexOf("small")!=-1&&(V.value=!V.value)};var _=null;const Oe=W=>{let U=720,k=1280;_=new ZLMRTCClient.Endpoint({element:document.getElementById("video"),debug:!0,zlmsdpUrl:`https://192.168.1.52/index/api/webrtc?app=live&stream=${W}&type=play`,simulcast:!1,useCamera:!0,audioEnable:!0,videoEnable:!0,recvOnly:!0,resolution:{w:k,h:U},usedatachannel:!1}),_.on(ZLMRTCClient.Events.WEBRTC_ICE_CANDIDATE_ERROR,function(E){console.log("ICE \u534F\u5546\u51FA\u9519")}),_.on(ZLMRTCClient.Events.WEBRTC_ON_REMOTE_STREAMS,function(E){console.log("\u64AD\u653E\u6210\u529F",E.streams)}),_.on(ZLMRTCClient.Events.WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED,function(E){console.log("offer anwser \u4EA4\u6362\u5931\u8D25",E),K()}),_.on(ZLMRTCClient.Events.WEBRTC_ON_LOCAL_STREAM,function(E){document.getElementById("video").srcObject=E,document.getElementById("video").muted=!0}),_.on(ZLMRTCClient.Events.CAPTURE_STREAM_FAILED,function(E){console.log("\u83B7\u53D6\u672C\u5730\u6D41\u5931\u8D25")}),_.on(ZLMRTCClient.Events.WEBRTC_ON_CONNECTION_STATE_CHANGE,function(E){ne.value=!0,console.log(ne.value,"\u64AD\u653E\u6210\u529F1111111111111111111111111111111111"),console.log("\u5F53\u524D\u72B6\u6001==>",E)}),_.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_OPEN,function(E){console.log("rtc datachannel \u6253\u5F00 :",E)}),_.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_MSG,function(E){console.log("rtc datachannel \u6D88\u606F :",E.data),document.getElementById("msgrecv").value=E.data}),_.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_ERR,function(E){console.log("rtc datachannel \u9519\u8BEF :",E)}),_.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_CLOSE,function(E){console.log("rtc datachannel \u5173\u95ED :",E)})},X=W=>{let U=720,k=1280;var E=new ZLMRTCClient.Endpoint({element:document.getElementById("video"),debug:!0,zlmsdpUrl:`https://default.zlmediakit.com/index/api/webrtc?app=live&stream=${W}&type=push`,simulcast:!1,useCamera:!0,audioEnable:!0,videoEnable:!0,recvOnly:!1,resolution:{w:k,h:U},usedatachannel:!1});E.on(ZLMRTCClient.Events.WEBRTC_ICE_CANDIDATE_ERROR,function(O){console.log("ICE \u534F\u5546\u51FA\u9519")}),E.on(ZLMRTCClient.Events.WEBRTC_ON_REMOTE_STREAMS,function(O){console.log("\u64AD\u653E\u6210\u529F",O.streams)}),E.on(ZLMRTCClient.Events.WEBRTC_OFFER_ANWSER_EXCHANGE_FAILED,function(O){console.log("offer anwser \u4EA4\u6362\u5931\u8D25",O)}),E.on(ZLMRTCClient.Events.WEBRTC_ON_LOCAL_STREAM,function(O){document.getElementById("selfVideo").srcObject=O,document.getElementById("selfVideo").muted=!0}),E.on(ZLMRTCClient.Events.CAPTURE_STREAM_FAILED,function(O){console.log("\u83B7\u53D6\u672C\u5730\u6D41\u5931\u8D25")}),E.on(ZLMRTCClient.Events.WEBRTC_ON_CONNECTION_STATE_CHANGE,function(O){console.log("\u5F53\u524D\u72B6\u6001==>",O)}),E.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_OPEN,function(O){console.log("rtc datachannel \u6253\u5F00 :",O)}),E.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_MSG,function(O){console.log("rtc datachannel \u6D88\u606F :",O.data),document.getElementById("msgrecv").value=O.data}),E.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_ERR,function(O){console.log("rtc datachannel \u9519\u8BEF :",O)}),E.on(ZLMRTCClient.Events.WEBRTC_ON_DATA_CHANNEL_CLOSE,function(O){console.log("rtc datachannel \u5173\u95ED :",O)})},K=()=>{_&&(_.close(),_=null,router.back())};return Mn(()=>{X(M.query.self),Oe(M.query.eachOther)}),Nn(()=>{K()}),(W,U)=>(In(),Ln("div",Hn,[Z("div",{onClick:Ae,ref:(k,E)=>{E.otherParty=k,ie.value=k},class:gr(["otherParty",[V.value?"big":"small"]])},Jn,2),Z("div",{class:gr(["my",[V.value?"small":"big"]]),ref:(k,E)=>{E.my=k,le.value=k}},[Z("video",{id:"selfVideo",autoplay:"",onClick:jn(B,["prevent"]),style:{width:"100%",height:"100%"}}," Your browser is too old which doesn't support HTML5 video. ",8,qn)],2),Z("div",$n,[Gn(Z("div",null,"\u6B63\u5728\u63A5\u901A\u4E2D,\u8BF7\u7B49\u5F85...",512),[[Bn,!ne.value]]),Z("img",{onClick:K,src:Wn,alt:""})])]))}},Kn=Dn(Zn,[["__scopeId","data-v-c81b39d0"]]);export{Kn as default};
